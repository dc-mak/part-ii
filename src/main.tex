% Whole document compilation
\newcommand{\setflag}{\newif \ifwhole \wholetrue}

% \usepackage{helvet}
% \renewcommand{\familydefault}{\sfdefault}

\newif\ifsans%
\sansfalse%

\ifsans%
\documentclass[11pt,a4paper,notitlepage,twoside,openright]{report}
\usepackage[sfdefault]{FiraSans}
\usepackage{FiraMono}
\usepackage{arevmath}
\else%
\documentclass[12pt,a4paper,notitlepage,twoside,openright]{report}
\fi%

\usepackage{adjustbox} % Rotated table headers
\usepackage{array} % Rotated table headers
\usepackage{booktabs} % Nice tables
\usepackage[headheight=15pt, top=1.1in, bottom=1.25in, left=1.25in, right=1.25in]{geometry} % 15pt for fancyhdr
\usepackage{docmute}  % For including stand-alone LaTeX documents as is
\usepackage{enumitem} % For referrable enumerated lists
\usepackage{fancyhdr} % Fancy headers
\usepackage[T1]{fontenc}
\usepackage[pdftitle={Exploring the structure of mathematical theories using graph databases},
            pdfauthor={Dhruv Makwana},
            pdfkeywords={mathematics, theorem, prover, graph, database, structure}]{hyperref} % (hyper)links
\usepackage[utf8x]{inputenc}
\usepackage[outputdir=build]{minted} % Source code highlighting
\usepackage{pgfplots} % Graphs
\usepackage{sectsty}  % San-serif section headers
\usepackage{tocloft}  % Control (format) table of contents, figures
\usepackage{titlesec} % For customising chapter titles
\usepackage{xcolor}   % More colour names
\usepackage{minitoc}  % Per Chapter Mini Table of Contents (load after)

% Formatting to allow flexible pages 
\raggedbottom{}
\sloppy
% penalise orphan lines/paragraphs
\clubpenalty1000%
\widowpenalty1000%

% Paragraph formatting
\parindent0pt%
\parskip6pt%

% Remove ugly boxes around hyperlinks
\hypersetup{%
    colorlinks,
    linkcolor={black},
    citecolor={green!50!black},
    urlcolor={blue!80!black}
}

% Include pink book guidance or not
\newif\ifguidance%
\guidancefalse%
\newcommand{\guidance}[1]{%
  \ifguidance%
  \textsf{\color{red}{#1}}
  \newpage
  \fi%
}%

% Fancy (and smaller) chapter heading style
\titleformat{\chapter}[hang]{\sffamily\Huge\bfseries}{%
\thechapter\hspace{20pt}\textcolor{lightgray}{|}\hspace{20pt}}{0pt}{\sffamily\Huge\bfseries}%

% Formatting Section headers
\setlength{\cftparskip}{6pt}% Spacing in ToC
\renewcommand{\cfttoctitlefont}{\normalfont\Huge\sffamily\bfseries}% sans ToC Title
\renewcommand{\cftchapfont}{\normalfont\sffamily\bfseries}% sans ToC chapter font
\renewcommand{\cftsecfont}{\normalfont\sffamily}% sans ToC section font
\renewcommand{\cftsubsecfont}{\normalfont\sffamily}% sans ToC subsection font
\allsectionsfont{\normalfont\sffamily\bfseries}% sans Sub*sections font
\setcounter{secnumdepth}{3}% Number subsubsections
\renewcommand{\thesubsubsection}{\Roman{subsubsection}}% with captial roman

% At the start of each chapter
\renewcommand{\mtctitle}{}
\newcommand*{\prechapter}[1]{%
\minitoc%
\bigskip%
\begin{center}%
  \begin{minipage}[h][][c]{0.8\linewidth}%
	#1
  \end{minipage}%
\end{center}

\newpage%
}

% Fancy evaluation table with slanted columns
% http://tex.stackexchange.com/questions/32683/rotated-column-titles-in-tabular#32690
\newcolumntype{R}[2]{%
    >{\adjustbox{angle=#1,lap=\width-(#2)}\bgroup}%
    l%
    <{\egroup}%
}
\newcommand*\rot{\multicolumn{1}{R{90}{0.8em}}}%

% Fancy boxes for fancy evaluation table
\newcommand{\Y}{\tikz \fill [green] (-0.3ex,0) rectangle (1.3ex,0.7em); }
\newcommand{\M}{\tikz \fill [cyan]  (-0.3ex,0) rectangle (1.3ex,0.7em); }
\newcommand{\N}{\tikz \fill [red]   (-0.3ex,0) rectangle (1.3ex,0.7em); }

\begin{document}

\input{src/title.tex}
\cleardoublepage{}

\setcounter{page}{1}
\pagenumbering{roman}
\pagestyle{plain}

\input{src/frontmatter.tex}
\cleardoublepage{}

\dominitoc% Initialisation
\setcounter{tocdepth}{1}
\tableofcontents
% For bold minitoc section headings, minitoc & tocloft conflict
\renewcommand{\cftsecfont}{\normalfont\sffamily\bfseries}% bold sans mintoc section font
\renewcommand{\cftsecleader}{\normalfont\sffamily\bfseries\cftdotfill{\cftdotsep}}% bold sans dots for sections
\renewcommand{\cftsecpagefont}{\bfseries}% bold (not sans for ToC & page consistency) page numbers
\cleardoublepage{}

\setcounter{page}{1}
\pagenumbering{arabic}
\pagestyle{fancy}

\input{src/introduction.tex}

\input{src/preparation.tex}

\input{src/implementation.tex}

\input{src/evaluation.tex}

\input{src/conclusions.tex}

\cleardoublepage{}
\phantomsection{} % Stop hyperlinks from going to the wrong page
\addcontentsline{toc}{chapter}{Bibliography}
\bibliographystyle{plain}
\bibliography{src/dissertation.bib}
\cleardoublepage{}

\appendix
\input{src/output.tex}
\cleardoublepage{}

\chapter{Project proposal}
\input{proposal/proposal.tex}

\end{document}
